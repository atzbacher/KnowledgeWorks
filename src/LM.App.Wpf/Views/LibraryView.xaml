<UserControl x:Class="LM.App.Wpf.Views.LibraryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="900">
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="310"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <!-- Filters Panel -->
    <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
      <StackPanel Margin="12">
        <TextBlock Text="Library Filters" FontWeight="Bold" Margin="0,0,0,8"/>
        <TextBlock Text="Title contains"/>
        <TextBox Text="{Binding TitleContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="Author contains"/>
        <TextBox Text="{Binding AuthorContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="Tags (comma-separated)"/>
        <TextBox Text="{Binding TagsCsv, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="Source contains"/>
        <TextBox Text="{Binding SourceContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="Internal ID contains"/>
        <TextBox Text="{Binding InternalIdContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="DOI contains"/>
        <TextBox Text="{Binding DoiContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="PMID contains"/>
        <TextBox Text="{Binding PmidContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="NCT contains"/>
        <TextBox Text="{Binding NctContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="Added by contains"/>
        <TextBox Text="{Binding AddedByContains, UpdateSourceTrigger=PropertyChanged}"/>

        <TextBlock Text="Type"/>
        <UniformGrid Columns="2" Margin="0,6,0,0">
          <CheckBox Content="Publication" IsChecked="{Binding TypePublication}"/>
          <CheckBox Content="Presentation" IsChecked="{Binding TypePresentation}"/>
          <CheckBox Content="White paper" IsChecked="{Binding TypeWhitePaper}"/>
          <CheckBox Content="Slide deck" IsChecked="{Binding TypeSlideDeck}"/>
          <CheckBox Content="Report" IsChecked="{Binding TypeReport}"/>
          <CheckBox Content="Other" IsChecked="{Binding TypeOther}"/>
        </UniformGrid>

        <TextBlock Text="Year range"/>
        <DockPanel>
          <TextBox Width="60" Text="{Binding YearFrom, UpdateSourceTrigger=PropertyChanged}"/>
          <TextBlock Text=" to " VerticalAlignment="Center" Margin="6,0,6,0"/>
          <TextBox Width="60" Text="{Binding YearTo, UpdateSourceTrigger=PropertyChanged}"/>
        </DockPanel>

        <TextBlock Text="Added on range"/>
        <DockPanel>
          <DatePicker Width="120" SelectedDate="{Binding AddedOnFrom, UpdateSourceTrigger=PropertyChanged}"/>
          <TextBlock Text=" to " VerticalAlignment="Center" Margin="6,0,6,0"/>
          <DatePicker Width="120" SelectedDate="{Binding AddedOnTo, UpdateSourceTrigger=PropertyChanged}"/>
        </DockPanel>

        <TextBlock Text="Visibility"/>
        <ComboBox SelectedValue="{Binding IsInternal}">
          <ComboBoxItem Content="Either" Tag="{x:Null}" IsSelected="True"/>
          <ComboBoxItem Content="External" Tag="False"/>
          <ComboBoxItem Content="Internal" Tag="True"/>
        </ComboBox>

        <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
          <Button Content="Search" Command="{Binding SearchCommand}"/>
          <Button Content="Clear" Command="{Binding ClearCommand}"/>
        </StackPanel>
      </StackPanel>
    </ScrollViewer>

    <!-- Results -->
    <Grid Grid.Column="1">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>

      <TextBlock Text="Results" FontWeight="Bold" Margin="12"/>

      <DataGrid Grid.Row="1"
                ItemsSource="{Binding Results}"
                SelectedItem="{Binding Selected}"
                Margin="12"
                IsReadOnly="True">
        <DataGrid.Columns>
          <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="3*"/>
          <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="2*"/>
          <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="1*"/>
          <DataGridTextColumn Header="Year" Binding="{Binding Year}" Width="0.8*"/>
          <DataGridTextColumn Header="Added on" Binding="{Binding AddedOnUtc, StringFormat='{}{0:yyyy-MM-dd HH:mm}'}" Width="1.2*"/>
          <DataGridTextColumn Header="Added by" Binding="{Binding AddedBy}" Width="1.2*"/>
          <DataGridTextColumn Header="Internal ID" Binding="{Binding InternalId}" Width="1.5*"/>
          <DataGridTextColumn Header="DOI" Binding="{Binding Doi}" Width="2*"/>
          <DataGridTextColumn Header="PMID" Binding="{Binding Pmid}" Width="1.5*"/>
          <DataGridTextColumn Header="NCT" Binding="{Binding Nct}" Width="1.5*"/>
          <DataGridTextColumn Header="Authors" Binding="{Binding Authors}" Width="2*"/>
          <DataGridTextColumn Header="Tags" Binding="{Binding Tags}" Width="2*"/>
          <DataGridTextColumn Header="Internal" Binding="{Binding IsInternal}" Width="0.8*"/>
        </DataGrid.Columns>
      </DataGrid>

      <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="12">
        <Button Content="Open" Command="{Binding OpenCommand}"/>
      </StackPanel>
    </Grid>
  </Grid>
</UserControl>
