<Window x:Class="LM.App.Wpf.Views.Review.LitSearchRunPickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:LM.App.Wpf.ViewModels.Dialogs"
        Title="Select LitSearch run"
        SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterOwner"
        MinWidth="720"
        MinHeight="420"
        mc:Ignorable="d"
        FocusManager.FocusedElement="{Binding ElementName=EntryList}">
  <Grid Margin="20">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="10" />
      <RowDefinition Height="*" />
      <RowDefinition Height="16" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <StackPanel Orientation="Vertical"
                Grid.Row="0">
      <TextBlock Text="Start a review from a LitSearch run"
                 FontSize="18"
                 FontWeight="SemiBold" />
      <TextBlock Text="Choose a LitSearch entry on the left and pick one of its runs to seed a new review project."
                 Margin="0,6,0,0"
                 TextWrapping="Wrap"
                 Opacity="0.7" />
    </StackPanel>

    <Grid Grid.Row="2">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="2*" />
        <ColumnDefinition Width="3*" />
      </Grid.ColumnDefinitions>

      <StackPanel Grid.Column="0"
                  Margin="0,0,12,0">
        <TextBlock Text="LitSearch entries"
                   FontWeight="SemiBold" />
        <Border Margin="0,8,0,0"
                Padding="1"
                BorderBrush="#33000000"
                BorderThickness="1"
                CornerRadius="4">
          <ListBox x:Name="EntryList"
                   ItemsSource="{Binding Entries}"
                   SelectedItem="{Binding SelectedEntry}"
                   DisplayMemberPath="Label"
                   HorizontalContentAlignment="Stretch"
                   MinWidth="220"
                   MinHeight="240" />
        </Border>
      </StackPanel>

      <StackPanel Grid.Column="1">
        <TextBlock Text="Runs"
                   FontWeight="SemiBold" />
        <Border Margin="0,8,0,0"
                Padding="1"
                BorderBrush="#33000000"
                BorderThickness="1"
                CornerRadius="4">
          <ListBox ItemsSource="{Binding SelectedEntry.Runs}"
                   SelectedItem="{Binding SelectedRun}"
                   HorizontalContentAlignment="Stretch"
                   MinWidth="320"
                   MinHeight="240">
            <ListBox.ItemTemplate>
              <DataTemplate DataType="{x:Type vm:LitSearchRunItemViewModel}">
                <StackPanel Orientation="Vertical"
                            Margin="4">
                  <TextBlock Text="{Binding DisplayLabel}" />
                  <TextBlock Text="{Binding Owner.Query}"
                             Margin="0,2,0,0"
                             FontSize="12"
                             Opacity="0.7"
                             TextTrimming="CharacterEllipsis" />
                </StackPanel>
              </DataTemplate>
            </ListBox.ItemTemplate>
          </ListBox>
        </Border>
      </StackPanel>
    </Grid>

    <Border Grid.Row="2"
            Background="#FFF9F9"
            BorderBrush="#33CC0000"
            BorderThickness="1"
            CornerRadius="4"
            Padding="12">
      <Border.Style>
        <Style TargetType="Border">
          <Setter Property="Visibility" Value="Collapsed" />
          <Style.Triggers>
            <DataTrigger Binding="{Binding HasEntries}" Value="False">
              <Setter Property="Visibility" Value="Visible" />
            </DataTrigger>
          </Style.Triggers>
        </Style>
      </Border.Style>
      <StackPanel>
        <TextBlock Text="No LitSearch runs found in this workspace."
                   FontWeight="SemiBold" />
        <TextBlock Text="Create a LitSearch run in the Search workspace before starting a review project."
                   Margin="0,4,0,0" />
      </StackPanel>
    </Border>

    <StackPanel Grid.Row="4"
                Orientation="Horizontal"
                HorizontalAlignment="Right">
      <Button Content="Cancel"
              Padding="18,6"
              Command="{Binding CancelCommand}" />
      <Button Content="Create project"
              Padding="18,6"
              Margin="12,0,0,0"
              Command="{Binding ConfirmCommand}" />
    </StackPanel>
  </Grid>
</Window>
