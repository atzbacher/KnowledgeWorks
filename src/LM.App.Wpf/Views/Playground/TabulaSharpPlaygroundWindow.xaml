<Window x:Class="LM.App.Wpf.Views.Playground.TabulaSharpPlaygroundWindow"
        x:ClassModifier="internal"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:LM.App.Wpf.Views.Controls"
        Title="TabulaSharp inspector"
        Width="1200"
        Height="720"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
  <Grid Margin="12">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="3*" />
      <ColumnDefinition Width="2.5*" />
    </Grid.ColumnDefinitions>

    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </Grid.RowDefinitions>

      <StackPanel Orientation="Horizontal" Margin="0,0,0,8" VerticalAlignment="Center">
        <Button Content="◀"
                Width="28"
                Command="{Binding GoToPreviousPageCommand}" />
        <TextBlock Text="{Binding CurrentPage}"
                   Margin="6,0,0,0"
                   VerticalAlignment="Center"
                   FontWeight="SemiBold" />
        <TextBlock Text="/"
                   Margin="4,0"
                   VerticalAlignment="Center" />
        <TextBlock Text="{Binding PageCount}"
                   VerticalAlignment="Center" />
        <Button Content="▶"
                Width="28"
                Margin="4,0,0,0"
                Command="{Binding GoToNextPageCommand}" />
        <Separator Margin="12,0" Width="1" />
        <Button Content="-"
                Width="28"
                Command="{Binding ZoomOutCommand}" />
        <TextBlock Text="{Binding Zoom, StringFormat={}{0:F2}×}"
                   Margin="4,0"
                   VerticalAlignment="Center" />
        <Button Content="+"
                Width="28"
                Command="{Binding ZoomInCommand}" />
        <Button Content="Reset zoom"
                Margin="8,0,0,0"
                Command="{Binding ResetZoomCommand}" />
      </StackPanel>

      <controls:PdfDocumentView Grid.Row="1"
                                DocumentPath="{Binding PdfPath}"
                                PageNumber="{Binding CurrentPage, Mode=TwoWay}"
                                PageCount="{Binding PageCount, Mode=OneWayToSource}"
                                Zoom="{Binding Zoom, Mode=TwoWay}" />
    </Grid>

    <Grid Grid.Column="1">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>

      <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
        <TextBlock Text="Extraction mode:" FontWeight="SemiBold" VerticalAlignment="Center" />
        <ComboBox ItemsSource="{Binding Modes}"
                  SelectedItem="{Binding SelectedMode, Mode=TwoWay}"
                  DisplayMemberPath="Name"
                  Margin="8,0,0,0"
                  Width="240" />
      </StackPanel>

      <TextBlock Grid.Row="1"
                 Text="{Binding SelectedMode.Description}"
                 TextWrapping="Wrap"
                 Foreground="Gray"
                 Margin="0,4,0,8" />

      <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,8" VerticalAlignment="Center">
        <Button Content="Run"
                Width="80"
                Command="{Binding RunCommand}" />
        <TextBlock Text="{Binding StatusMessage}"
                   Margin="12,0,0,0"
                   VerticalAlignment="Center"
                   TextWrapping="Wrap"
                   Width="320" />
      </StackPanel>

      <Grid Grid.Row="3">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="240" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0"
                Margin="0,0,12,0"
                Padding="8"
                BorderThickness="1"
                BorderBrush="#FFCCCCCC"
                CornerRadius="4">
          <StackPanel>
            <TextBlock Text="Detected tables"
                       FontWeight="SemiBold"
                       Margin="0,0,0,6" />
            <ListBox ItemsSource="{Binding Tables}"
                     SelectedItem="{Binding SelectedTable, Mode=TwoWay}"
                     BorderThickness="0"
                     Height="260">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <StackPanel>
                    <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" />
                    <TextBlock Text="{Binding RowCount, StringFormat=Rows: {0}}"
                               Foreground="Gray"
                               FontSize="11" />
                  </StackPanel>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
            <TextBlock Text="Select a table to preview its cells." Foreground="Gray" FontSize="11" />
          </StackPanel>
        </Border>

        <Grid Grid.Column="1">
          <DataGrid ItemsSource="{Binding SelectedTableView}"
                    AutoGenerateColumns="True"
                    IsReadOnly="True"
                    HeadersVisibility="Column"
                    CanUserAddRows="False"
                    CanUserDeleteRows="False"
                    Margin="0"
                    RowHeaderWidth="0" />
          <TextBlock Text="Run TabulaSharp to populate table output."
                     Foreground="Gray"
                     FontStyle="Italic"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center">
            <TextBlock.Style>
              <Style TargetType="TextBlock">
                <Setter Property="Visibility" Value="Collapsed" />
                <Style.Triggers>
                  <DataTrigger Binding="{Binding SelectedTableView}" Value="{x:Null}">
                    <Setter Property="Visibility" Value="Visible" />
                  </DataTrigger>
                </Style.Triggers>
              </Style>
            </TextBlock.Style>
          </TextBlock>
        </Grid>
      </Grid>

      <StackPanel Grid.Row="4"
                  Orientation="Horizontal"
                  HorizontalAlignment="Right"
                  Margin="0,12,0,0">
        <Button Content="Close"
                Width="100"
                Command="{Binding CloseCommand}" />
      </StackPanel>
    </Grid>
  </Grid>
</Window>
